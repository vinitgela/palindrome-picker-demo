<!DOCTYPE html>
<html>
<head>
  <title>Palindrome File Picker PoC</title>
  <script type="text/javascript" src="https://js.live.net/v7.2/OneDrive.js"></script>
</head>
<body>
  <h2>üìÇ Palindrome File Picker</h2>
  <button onclick="launchPicker()">Open File Picker</button>

  <pre id="output" style="margin-top:20px; background:#f0f0f0; padding:10px;"></pre>

  <script>
    function launchPicker() {
      var odOptions = {
        clientId: "6040fbff-0e17-4c99-93c3-23e98b0740b9",
        action: "query",
        multiSelect: true,
        openInNewWindow: true,
        advanced: {
          redirectUri: "https://vinitgela.github.io/palindrome-picker/auth-redirect.html",  // UPDATE THIS
          filter: ".pdf,.docx,.xlsx"
        },
        success: function(files) {
          document.getElementById("output").textContent = JSON.stringify(files, null, 2);
        },
        cancel: function() {
          document.getElementById("output").textContent = "‚ùå Picker canceled.";
        },
        error: function(e) {
          document.getElementById("output").textContent = "‚ö†Ô∏è Error: " + JSON.stringify(e, null, 2);
        }
      };
      OneDrive.open(odOptions);
    }
  </script>
</body>
</html>
